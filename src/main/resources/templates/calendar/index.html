<!DOCTYPE html>
<html lang='en' xmlns="http://www.w3.org/1999/html">
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="common :: header(metaTitle='Task list')"></head>

<body class="container">
<div class="with:80%">
    <br/>
    <h1>Calendar</h1>
    <br/>
    <div class="row gutters-sm">
        <div th:replace="~{common::#sidebar}"></div>
        <div class="col-md-9 d-none d-md-block">
            <div class="card">
                <div class="card-body">
                    <div id='calendar'></div>
                </div>
            </div>
        </div>
    </div>
    <input id="todos" th:value="${todos}" type="hidden"/>
</div>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>
<script>
        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                events: getToDos(),
                eventClick: function(info) {
                    console.log('Event: ' + info.event.title);
                    console.log('Event Id: ' + info.event.id);
                    info.el.style.borderColor = 'green';
                    editToDo(info.event.id);
                }
            });
            calendar.render();
        });

        function getToDos(){
            var val = $("#todos").val();
            return JSON.parse(val.replace(/&quot;/g,'"'));
        }

        function editToDo(id){
            if (id) {
                window.location.href = window.location.href.replace('calendar', 'todo?id=' + id);
            }
        }




</script>
</body>

</html>